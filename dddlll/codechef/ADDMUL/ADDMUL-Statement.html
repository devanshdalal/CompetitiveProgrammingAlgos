<div id="node-8696217" class="node clear-block"> 
 <div class="meta"> 
 </div> 
 <div class="content"> 
  <h3>All submissions for this problem are available.</h3>
  <h3>Read problems statements in <a href="/download/translated/JULY15/mandarin/ADDMUL.pdf" target="_blank">Mandarin Chinese </a> and <a href="/download/translated/JULY15/russian/ADDMUL.pdf" target="_blank">Russian</a>.</h3> 
  <p>You are given a one dimensional integer array <b>A</b> of length <b>N</b>. You need to maintain the array under <b>Q</b> queries of the following four types. Assume 1-based indexing and M = 10<sup>9</sup> + 7.</p> 
  <p><b>Query 1</b> : 1 x y v <br><br> This implies adding v to array <b>A</b> to all the indices from x to y, i.e.,<br> <code></code></p> 
  <pre>for (i = x; i &lt;= y; i++)	
	<b>A</b><sub>i</sub> += v;
	<b>A</b><sub>i</sub> %= M; 
</pre> 
  <p>&nbsp;</p> 
  <p><b>Query 2</b> : 2 x y v <br> This implies multiplying the scalar v with the array <b>A</b> for all the indices from x to y, i.e.,<br> <code></code></p> 
  <pre>for (i = x; i &lt;= y; i++)	
        <b>A</b><sub>i</sub> *= v
        <b>A</b><sub>i</sub> %= M
</pre> 
  <p>&nbsp;</p> 
  <p><b>Query 3</b> : 3 x y v <br> This implies initializing the array <b>A</b> at all the indices from x to y with the value v, i.e.,<br> <code></code></p> 
  <pre>for (i = x; i &lt;= y; i++)	
	<b>A</b><sub>i</sub> = v 
</pre> 
  <p>&nbsp;</p> 
  <p><b>Query 4</b> : 4 x y<br><br> This is a report query which needs to find the sum of the values in <b>A</b> from x to y, i.e.,<br> <code></code></p> 
  <pre>sum = 0;
for (i = x; i &lt;= y; i++)
	sum += <b>A</b><sub>i</sub>
	sum %= M
Output sum.
</pre> 
  <p>&nbsp;</p> 
  <p><b>Note:</b> a%b represents the remainder of a when divided by b.</p> 
  <h3>Input</h3> 
  <ul> 
   <li>First line contains two space separated integers <b>N</b>, <b>Q</b>.</li> 
   <li>Next line contains <b>N</b> space separated integers denoting the array <b>A</b>.</li> 
   <li>Next <b>Q</b> lines contain queries which can be of any of the above four types.</li> 
  </ul> 
  <h3>Output</h3> 
  <ul> 
   <li>For each query of type 4, output a single integer corresponding to the answer in a single line.</li> 
  </ul> 
  <h3>Constraints</h3> 
  <ul> 
   <li>1 ≤ <b>N</b> ≤ 10<sup>5</sup></li> 
   <li>1 ≤ <b>Q</b> ≤ 10<sup>5</sup></li> 
   <li>1 ≤ Initial value of <b>A</b><sub>i</sub> ≤ 10<sup>9</sup></li> 
   <li>1 ≤ <b>v</b> ≤ 10<sup>9</sup></li> 
  </ul> 
  <h3>Subtasks</h3> 
  <ul> 
   <li> <b>Subtask 1</b>: Queries are of type 1, 3 and 4. <b>Points - 5</b>.</li> 
   <li> <b>Subtask 2</b>: Queries are of type 2, 3 and 4. <b>Points - 5</b>.</li> 
   <li> <b>Subtask 3</b>: Queries are of type 1, 2 and 4. <b>Points - 30</b>.</li> 
   <li> <b>Subtask 4</b>: All the queries are present. <b>Points - 60</b>.</li> 
  </ul> 
  <h3>Example</h3> 
  <pre><b>Input:</b>
4 4
1 2 3 4
4 1 4
1 1 3 10
2 2 4 2
4 1 4

<b>Output:</b>
10
69

</pre> 
  <h3>Explanation</h3> 
  <p>Initial <b>A</b> : [1, 2, 3, 4]<br> Result of first query : 1 + 2 + 3 + 4 = 10<br> <b>A</b> after second query: [ 11, 12, 13, 4]<br> <b>A</b> after third query : [ 11, 24, 26, 8]<br> Result of fourth query : 11 + 24 + 26 + 8 = 69</p> 
 </div> 
 <hr> 
 <table cellspacing="0" cellpadding="0" align="left"> 
  <tbody>
   <tr> 
    <td width="14%">Author:</td> 
    <td><a href="/users/devuy11">devuy11</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tester:</td> 
    <td><a href="/users/mugurelionut">mugurelionut</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Editorial</td> 
    <td><a href="http://discuss.codechef.com/problems/ADDMUL">http://discuss.codechef.com/problems/ADDMUL</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tags</td> 
    <td><a class="problem-tag-small " href="/tags/problems/devuy11"> devuy11 </a><a class="problem-tag-small " href="/tags/problems/july15"> july15 </a><a class="problem-tag-small " href="/tags/problems/lazypropagation"> lazypropagation </a><a class="problem-tag-small " href="/tags/problems/medium"> medium </a><a class="problem-tag-small " href="/tags/problems/segment-tree"> segment-tree </a></td> 
   </tr> 
   <tr> 
    <td width="14%">Date Added:</td> 
    <td>6-05-2014</td> 
   </tr> 
   <tr> 
    <td width="14%">Time Limit:</td> 
    <td>1 sec</td> 
   </tr> 
   <tr> 
    <td width="14%">Source Limit:</td> 
    <td>50000 Bytes</td> 
   </tr> 
   <tr> 
    <td width="14%">Languages:</td> 
    <td>ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.1.2, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC</td> 
   </tr> 
  </tbody>
 </table> 
 <p style="clear:left;"><br></p> 
 <ul class="button-list button-list-left"> 
  <li style="display:"><a href="/submit/ADDMUL">Submit</a></li> 
 </ul> 
 <hr> 
 <h2 style="text-decoration: none;">Comments</h2> 
 <ul class="links inline">
  <li class="comment_forbidden first last"><span><i><strong>Please login at the top to post a comment.</strong></i><p></p></span></li> 
 </ul>
</div> 
<div id="comments"> 
 <a id="comment-109074"></a> 
 <div id="c109074" class="comment clear-block"> 
  <h3><a href="/problems/ADDMUL#comment-109074" class="active">Very nice problem...feeling</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/hmnshgpt455">hmnshgpt455</a></strong>
   <span style="color:#828282"> @ 15 Jul 2015 01:20 AM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Very nice problem...feeling awesome after getting ac :D
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-109088"></a> 
 <div id="c109088" class="comment clear-block"> 
  <h3><a href="/problems/ADDMUL#comment-109088" class="active">this is madness itself!!</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/mk47">mk47</a></strong>
   <span style="color:#828282"> @ 15 Jul 2015 08:15 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    this is madness itself!!
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-109824"></a> 
 <div id="c109824" class="comment clear-block"> 
  <h3><a href="/problems/ADDMUL#comment-109824" class="active">m getting tle..can anyone plz</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/pkdhirasaria">pkdhirasaria</a></strong>
   <span style="color:#828282"> @ 19 Jul 2015 11:26 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    m getting tle..can anyone plz help me....?..https://www.codechef.com/viewsolution/7500735
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-109825"></a> 
 <div id="c109825" class="comment clear-block"> 
  <h3><a href="/problems/ADDMUL#comment-109825" class="active">i even used faster input</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/pkdhirasaria">pkdhirasaria</a></strong>
   <span style="color:#828282"> @ 19 Jul 2015 11:26 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    i even used faster input getchar unlocked...
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-113715"></a> 
 <div id="c113715" class="comment clear-block"> 
  <h3><a href="/problems/ADDMUL#comment-113715" class="active">awesome problem finally got</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/aggarwalkeshav">aggarwalkeshav</a></strong>
   <span style="color:#828282"> @ 24 Aug 2015 06:55 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    awesome problem finally got ac!!
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
</div>