<div id="node-6835102" class="node clear-block"> 
 <div class="meta"> 
 </div> 
 <div class="content"> 
  <h3>All submissions for this problem are available.</h3>
  <h3>Read problems statements in <a href="/download/translated/DEC14/mandarin/CHEFPRES.pdf" target="_blank">Mandarin Chinese </a> and <a href="/download/translated/DEC14/russian/CHEFPRES.pdf" target="_blank">Russian</a>.</h3> 
  <p>Chef is about to leave his home and live in a place called The Kingdom. There are <b>N</b> cities in this kingdom, and they are connected by bidirectional roads such that there is exactly one simple path between every 2 cities. The Kingdom is very unusual in that each road that connects two cities is exactly the same length.</p> 
  <p>The King has a monopoly over all commerce in the city and has very strict rules - he does not allow the citizens of a given city to sell more than one product. So in each city the desperate citizens sell exactly one product. There are <b>K</b> distinct products being sold overall in the Kingdom.</p> 
  <p>Let's number the cities with integers from <b>1</b> to <b>N</b>, and the products from <b>1</b> to <b>K</b>. The King lives in the capital city, city <b>B</b>. For each city <b>i</b>, the product that is sold in that city is denoted by <b>F(i)</b>.</p> 
  <p>After Chef has arrived and settled in, he plans to create a new recipe. This will require a certain product <b>P</b>, but this product may not be available in the city he will be living in - he will need to travel to that city to purchase it. Knowing the King's temper and remembering unpleasant incidents between him and the King in the past, Chef wants to stay as far as possible from the capital city (numbered <b>B</b>) during his travels.</p> 
  <p>Specifically, suppose Chef will be living in the city <b>A</b>. For each city <b>i</b>, let <b>G(i)</b> be the smallest distance between <b>B</b> and any city on the unique path connecting cities <b>A</b> and <b>i</b>. Chef wants to travel to the city <b>C</b> such that:</p> 
  <ul> 
   <li><b>F(C)</b>=<b>P</b> </li> 
   <li>There is no other city <b>D</b> having <b>F(D)</b>=<b>P</b> and <b>G(D)</b> &gt; <b>G(C)</b>.</li> 
  </ul> 
  <p>If there are several cities with this property, Chef will choose the one with the smallest number. It is possible that <b>C</b> may equal <b>A</b>, in which case he does not have to travel at all.</p> 
  <p>Chef has not yet decided which city to live in, nor which recipe to create. You are required to answer several queries for him - if he lives in city <b>A</b>, and requires product <b>P</b>, which city should he travel to in order to purchase it?</p> 
  <h3>Input</h3> 
  <p>The first line of the input contains 2 integers: <b>N</b> and <b>K</b>. The next line contains the number <b>B</b> - the capital city of The Kingdom.</p> 
  <p>After this, there will be <b>N</b>-1 lines, each containing integers representing two cities, <b>X</b> and <b>Y</b> - indicating that there is a bidirectional road between cities <b>X</b> and <b>Y</b>.</p> 
  <p>The next <b>N</b> lines contain the description of cities: the <b>i</b>-th line contains a single integer <b>F(i)</b> - the product being sold in city <b>i</b>.</p> 
  <p>The next line will contain the number of queries, <b>Q</b>. The next <b>Q</b> lines contain 2 integers: <b>A</b> and <b>P</b>: the city Chef will be living in, and the product he requires.</p> 
  <h3>Output</h3> 
  <p>For each of the <b>Q</b> queries, output on separate lines the number of the city from which Chef should buy the given product from, if there is any. Otherwise output <b>-1</b>.</p> 
  <h3>Constraints</h3> 
  <ul> 
   <li>1 ≤ <b>K</b> ≤ 100</li> 
  </ul> 
  <h3>Subtask 1: [point 20]</h3> 
  <ul> 
   <li>1 ≤ <b>N</b> ≤ 100</li> 
   <li>1 ≤ <b>Q</b> ≤ 100</li> 
  </ul> 
  <h3>Subtask 2:[point 80]</h3> 
  <ul> 
   <li>1 ≤ <b>N</b> ≤ 10<sup>4</sup></li> 
   <li>1 ≤ <b>Q</b> ≤ 10<sup>4</sup></li> 
  </ul> 
  <h3>Example</h3> 
  <pre><b>Input:</b>
8 4
8
3 2
2 1
1 8
8 6
8 7
7 4
4 5
3
2
3
4
1
1
4
4
8
2 1
2 2
2 3
2 4
8 1
8 2
8 3
8 4

<b>Output:</b>
5
2
3
4
5
2
1
4

</pre> 
  <h3>Explanation</h3> 
  <p>In the first query, Chef must purchase product 1 from either city 5 or city 6. In both cases Chef will pass directly through the capital while travelling from city 2, so he chooses the smallest city number, 5.</p> 
  <p>In the third query, the path from city 2 to city 3 is always at least 2 steps away from the capital. The path from city 2 to city 1 is less preferred, as the path comes within 1 step of the capital.</p> 
 </div> 
 <hr> 
 <table cellspacing="0" cellpadding="0" align="left"> 
  <tbody>
   <tr> 
    <td width="14%">Author:</td> 
    <td><a href="/users/kamranmaharov ">kamranmaharov </a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tester:</td> 
    <td><a href="/users/shiplu">shiplu</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Editorial</td> 
    <td><a href="http://discuss.codechef.com/problems/CHEFPRES">http://discuss.codechef.com/problems/CHEFPRES</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tags</td> 
    <td><a class="problem-tag-small " href="/tags/problems/dec14"> dec14 </a><a class="problem-tag-small " href="/tags/problems/dfs"> dfs </a><a class="problem-tag-small " href="/tags/problems/kamranmaharov "> kamranmaharov </a><a class="problem-tag-small " href="/tags/problems/medium"> medium </a><a class="problem-tag-small " href="/tags/problems/tree"> tree </a></td> 
   </tr> 
   <tr> 
    <td width="14%">Date Added:</td> 
    <td>9-09-2012</td> 
   </tr> 
   <tr> 
    <td width="14%">Time Limit:</td> 
    <td>1 - 2 sec</td> 
   </tr> 
   <tr> 
    <td width="14%">Source Limit:</td> 
    <td>50000 Bytes</td> 
   </tr> 
   <tr> 
    <td width="14%">Languages:</td> 
    <td>ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.1.2, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC</td> 
   </tr> 
  </tbody>
 </table> 
 <p style="clear:left;"><br></p> 
 <ul class="button-list button-list-left"> 
  <li style="display:"><a href="/submit/CHEFPRES">Submit</a></li> 
 </ul> 
 <hr> 
 <h2 style="text-decoration: none;">Comments</h2> 
 <ul class="links inline">
  <li class="comment_forbidden first last"><span><i><strong>Please login at the top to post a comment.</strong></i><p></p></span></li> 
 </ul>
</div> 
<div id="comments"> 
 <a id="comment-91899"></a> 
 <div id="c91899" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-91899" class="active">Really the question is just</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/tapopadma">tapopadma</a></strong>
   <span style="color:#828282"> @ 16 Dec 2014 12:47 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Really the question is just about finding LCA :( ,,,, There's no need to measure distance between any cities ,,, I was doing both in the contest :(
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-107053"></a> 
 <div id="c107053" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-107053" class="active">Hey, previous AC solutions</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/droidkid">droidkid</a></strong>
   <span style="color:#828282"> @ 21 Jun 2015 01:18 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Hey, previous AC solutions are getting only 80 points now, can anyone look into this?
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-115212"></a> 
 <div id="c115212" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-115212" class="active">Hey, in the test case of the</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/cri1_rohit">cri1_rohit</a></strong>
   <span style="color:#828282"> @ 1 Sep 2015 05:18 AM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Hey, in the test case of the problem "Chef Under Pressure" the last input is "8 4" , which means that the chef will stay in the city number 8 and want product number 4. The city 8 itself has product 4 so he need not move to any other city to get it. But the output states that he should go to city number "4" to get it. Why is it so?
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-115355"></a> 
 <div id="c115355" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-115355" class="active">Hi All, cri1.. for the above</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/imharish_1981">imharish_1981</a></strong>
   <span style="color:#828282"> @ 1 Sep 2015 04:31 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Hi All, cri1.. for the above input 8,4 condition 2 [◾There is no other city D having F(D)=P and G(D) &gt; G(C).] does not satisfy. You have to find the further most city from B ... but I feel the answer to 7th query is not right as it should be 3 as 3 is farthest not 1. Plz chk..
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-115559"></a> 
 <div id="c115559" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-115559" class="active">Thanks for mour information</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/sonigupta">sonigupta</a></strong>
   <span style="color:#828282"> @ 2 Sep 2015 01:11 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Thanks for mour information visit for link: 
    <a href="http://3th.co.in/packers-and-movers-delhi/" title="http://3th.co.in/packers-and-movers-delhi/">http://3th.co.in/packers-and-movers-delhi/</a> 
    <a href="http://3th.co.in/packers-and-movers-noida/" title="http://3th.co.in/packers-and-movers-noida/">http://3th.co.in/packers-and-movers-noida/</a> 
    <a href="http://3th.co.in/packers-and-movers-ghaziabad/" title="http://3th.co.in/packers-and-movers-ghaziabad/">http://3th.co.in/packers-and-movers-ghaziabad/</a> 
    <a href="http://3th.co.in/packers-and-movers-faridabad/" title="http://3th.co.in/packers-and-movers-faridabad/">http://3th.co.in/packers-and-movers-faridabad/</a>
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-115595"></a> 
 <div id="c115595" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-115595" class="active">Thanks for More information</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/sonigupta">sonigupta</a></strong>
   <span style="color:#828282"> @ 2 Sep 2015 01:13 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Thanks for More information provide Export moving services shifting 
    <a href="http://www.export5th.in/packers-and-movers-in-pune/" title="http://www.export5th.in/packers-and-movers-in-pune/">http://www.export5th.in/packers-and-movers-in-pune/</a> 
    <a href="http://www.export5th.in/packers-and-movers-in-mumbai/" title="http://www.export5th.in/packers-and-movers-in-mumbai/">http://www.export5th.in/packers-and-movers-in-mumbai/</a> 
    <a href="http://www.export5th.in/packers-and-movers-in-bangalore/" title="http://www.export5th.in/packers-and-movers-in-bangalore/">http://www.export5th.in/packers-and-movers-in-bangalore/</a> 
    <a href="http://www.export5th.in/packers-and-movers-in-hyderabad/" title="http://www.export5th.in/packers-and-movers-in-hyderabad/">http://www.export5th.in/packers-and-movers-in-hyderabad/</a>
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-115600"></a> 
 <div id="c115600" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-115600" class="active">Thanks for mour information</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/sonigupta">sonigupta</a></strong>
   <span style="color:#828282"> @ 2 Sep 2015 01:13 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Thanks for mour information visit: 
    <a href="http://top3th.co.in/packers-and-movers-gurgaon/" title="http://top3th.co.in/packers-and-movers-gurgaon/">http://top3th.co.in/packers-and-movers-gurgaon/</a> 
    <a href="http://top3th.co.in/packers-and-movers-delhi/" title="http://top3th.co.in/packers-and-movers-delhi/">http://top3th.co.in/packers-and-movers-delhi/</a> 
    <a href="http://top3th.co.in/packers-and-movers-navi-mumbai/" title="http://top3th.co.in/packers-and-movers-navi-mumbai/">http://top3th.co.in/packers-and-movers-navi-mumbai/</a> 
    <a href="http://top3th.co.in/packers-and-movers-thane/" title="http://top3th.co.in/packers-and-movers-thane/">http://top3th.co.in/packers-and-movers-thane/</a>
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-117263"></a> 
 <div id="c117263" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-117263" class="active">Thanks for More information</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/josisonali">josisonali</a></strong>
   <span style="color:#828282"> @ 9 Sep 2015 01:40 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Thanks for More information this article visit link: 
    <a href="http://list5th.in/" title="http://list5th.in/">http://list5th.in/</a> 
    <a href="http://list5th.in/packers-and-movers-pune/" title="http://list5th.in/packers-and-movers-pune/">http://list5th.in/packers-and-movers-pune/</a> 
    <a href="http://list5th.in/packers-and-movers-mumbai/" title="http://list5th.in/packers-and-movers-mumbai/">http://list5th.in/packers-and-movers-mumbai/</a> 
    <a href="http://list5th.in/packers-and-movers-hyderabad/" title="http://list5th.in/packers-and-movers-hyderabad/">http://list5th.in/packers-and-movers-hyderabad/</a> 
    <a href="http://list5th.in/packers-and-movers-gurgaon/" title="http://list5th.in/packers-and-movers-gurgaon/">http://list5th.in/packers-and-movers-gurgaon/</a>
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-117599"></a> 
 <div id="c117599" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-117599" class="active">Thanks for mour information</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/josisonali">josisonali</a></strong>
   <span style="color:#828282"> @ 11 Sep 2015 05:28 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Thanks for mour information Visit link: 
    <a href="http://www.the5th.in/packers-and-movers-mumbai.html" title="http://www.the5th.in/packers-and-movers-mumbai.html">http://www.the5th.in/packers-and-movers-mumbai.html</a> 
    <a href="http://www.the5th.in/packers-and-movers-gurgaon.html" title="http://www.the5th.in/packers-and-movers-gurgaon.html">http://www.the5th.in/packers-and-movers-gurgaon.html</a> 
    <a href="http://www.the5th.in/packers-and-movers-pune.html" title="http://www.the5th.in/packers-and-movers-pune.html">http://www.the5th.in/packers-and-movers-pune.html</a> 
    <a href="http://www.the5th.in/packers-and-movers-bangalore.html" title="http://www.the5th.in/packers-and-movers-bangalore.html">http://www.the5th.in/packers-and-movers-bangalore.html</a> 
    <a href="http://www.the5th.in/" title="http://www.the5th.in/">http://www.the5th.in/</a>
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-117913"></a> 
 <div id="c117913" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-117913" class="active">shouldn't the answer to query</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/parnika14">parnika14</a></strong>
   <span style="color:#828282"> @ 15 Sep 2015 09:27 AM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    shouldn't the answer to query no 7 be 3..?
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-118019"></a> 
 <div id="c118019" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-118019" class="active">Thanks for more information</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/josisonali">josisonali</a></strong>
   <span style="color:#828282"> @ 15 Sep 2015 05:28 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Thanks for more information about visit link: 
    <a href="http://www.adword.co.in/" title="http://www.adword.co.in/">http://www.adword.co.in/</a> 
    <a href="http://www.adword.co.in/packers-and-movers-hyderabad/" title="http://www.adword.co.in/packers-and-movers-hyderabad/">http://www.adword.co.in/packers-and-movers-hyderabad/</a> 
    <a href="http://www.adword.co.in/packers-and-movers-mumbai/" title="http://www.adword.co.in/packers-and-movers-mumbai/">http://www.adword.co.in/packers-and-movers-mumbai/</a> 
    <a href="http://www.adword.co.in/packers-and-movers-pune/" title="http://www.adword.co.in/packers-and-movers-pune/">http://www.adword.co.in/packers-and-movers-pune/</a>
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-118037"></a> 
 <div id="c118037" class="comment clear-block"> 
  <h3><a href="/problems/CHEFPRES#comment-118037" class="active">Thanks for more information</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/josisonali">josisonali</a></strong>
   <span style="color:#828282"> @ 15 Sep 2015 05:29 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Thanks for more information about visit this link: 
    <a href="http://www.adword.co.in/packers-and-movers-bangalore/" title="http://www.adword.co.in/packers-and-movers-bangalore/">http://www.adword.co.in/packers-and-movers-bangalore/</a> 
    <a href="http://www.adword.co.in/packers-and-movers-delhi/" title="http://www.adword.co.in/packers-and-movers-delhi/">http://www.adword.co.in/packers-and-movers-delhi/</a> 
    <a href="http://www.adword.co.in/packers-and-movers-gurgaon/" title="http://www.adword.co.in/packers-and-movers-gurgaon/">http://www.adword.co.in/packers-and-movers-gurgaon/</a>
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
</div>