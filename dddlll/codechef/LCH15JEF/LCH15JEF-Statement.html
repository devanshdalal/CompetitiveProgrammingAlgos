<div id="node-7226997" class="node clear-block"> 
 <div class="meta"> 
 </div> 
 <div class="content"> 
  <h3>All submissions for this problem are available.</h3>
  <h3> Read problems statements in <a target="_blank" href="http://www.codechef.com/download/translated/LTIME20/mandarin/LCH15JEF.pdf">Mandarin Chinese </a> and <a target="_blank" href="http://www.codechef.com/download/translated/LTIME20/russian/LCH15JEF.pdf">Russian</a>.</h3> 
  <p> Leonid is developing new programming language. The key feature of his language is fast multiplication and raising to a power operations. He is asking you to help with the following task. </p> 
  <p>You have an expression <b>S</b> and positive integer <b>M</b>. <b>S</b> has the following structure: <b>A<sub>1</sub>*A<sub>2</sub>*...*A<sub>n</sub></b> where "*" is multiplication operation. Each <b>A<sub>i</sub></b> is an expression <b>X<sub>i</sub>**Y<sub>i</sub></b> where <b>X<sub>i</sub></b> and <b>Y<sub>i</sub></b> are non-negative integers and "**" is raising <b>X<sub>i</sub></b> to power <b>Y<sub>i</sub></b> operation. </p> 
  <p>.</p> 
  <p>Your task is just to find the value of an expression <b>S</b> modulo <b>M</b> </p> 
  <h3>Input</h3> 
  <p>The first line of the input contains an integer <b>T</b> denoting the number of test cases. Each of the following <b>T</b> testcases is described by one line which contains one positive integer <b>M</b> and expression <b>S</b> separated by whitespace.</p> 
  <h3>Output</h3> 
  <p>For each test case, output a single line containing one integer corresponding to value of <b>S</b> modulo <b>M</b> </p> 
  <h3>Constraints</h3> 
  <ul> 
   <li><b>1</b> ≤ <b>T</b> ≤ <b>20</b></li> 
   <li> <b>1</b> ≤ <b>M</b> ≤ <b>10<sup>18</sup></b></li> 
   <li> <b>1</b> ≤ <b>length of S</b> ≤ <b>10<sup>4</sup></b></li> 
   <li> <b>0</b> ≤ <b>X<sub>i</sub>, Y<sub>i</sub></b> ≤ <b>10<sup>9997</sup></b> </li> 
   <li>It's guaranteed that there will not be <b>0**0</b> expression</li> 
  </ul> 
  <h3> Subtasks </h3> 
  <p><b>Subtask #1</b>[30 points]: <b>X<sub>i</sub>, Y<sub>i</sub></b> &lt; <b>10</b>, <b>M</b> &lt; <b>10 <sup>4</sup></b><br> <b>Subtask #2</b>[40 points]: <b>M</b> &lt; <b>10<sup>9</sup></b><br> <b>Subtask #3</b>[30 points]: no additional conditions</p> 
  <h3>Example</h3> 
  <pre><b>Input:</b>
2
1000 2**3*3**1
100000 11**2*2**4
<b>Output:</b>
24
1936
</pre> 
 </div> 
 <hr> 
 <table cellspacing="0" cellpadding="0" align="left"> 
  <tbody>
   <tr> 
    <td width="14%">Author:</td> 
    <td><a href="/users/pavel1996">pavel1996</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tester:</td> 
    <td><a href="/users/rubanenko">rubanenko</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tags</td> 
    <td><a class="problem-tag-small " href="/tags/problems/bignum"> bignum </a><a class="problem-tag-small " href="/tags/problems/easy"> easy </a><a class="problem-tag-small " href="/tags/problems/implementation"> implementation </a><a class="problem-tag-small " href="/tags/problems/ltime20"> ltime20 </a><a class="problem-tag-small " href="/tags/problems/maths"> maths </a><a class="problem-tag-small " href="/tags/problems/pavel1996"> pavel1996 </a></td> 
   </tr> 
   <tr> 
    <td width="14%">Date Added:</td> 
    <td>25-12-2014</td> 
   </tr> 
   <tr> 
    <td width="14%">Time Limit:</td> 
    <td>2 - 3 sec</td> 
   </tr> 
   <tr> 
    <td width="14%">Source Limit:</td> 
    <td>50000 Bytes</td> 
   </tr> 
   <tr> 
    <td width="14%">Languages:</td> 
    <td>ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.1.2, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC</td> 
   </tr> 
  </tbody>
 </table> 
 <p style="clear:left;"><br></p> 
 <ul class="button-list button-list-left"> 
  <li style="display:"><a href="/submit/LCH15JEF">Submit</a></li> 
 </ul> 
 <hr> 
 <h2 style="text-decoration: none;">Comments</h2> 
 <ul class="links inline">
  <li class="comment_forbidden first last"><span><i><strong>Please login at the top to post a comment.</strong></i><p></p></span></li> 
 </ul>
</div> 
<div id="comments"> 
 <a id="comment-94939"></a> 
 <div id="c94939" class="comment clear-block"> 
  <h3><a href="/problems/LCH15JEF#comment-94939" class="active">This question is made for</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/iamkode_chef">iamkode_chef</a></strong>
   <span style="color:#828282"> @ 28 Jan 2015 07:30 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    This question is made for languages such as java or python. Give it a try.
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-95372"></a> 
 <div id="c95372" class="comment clear-block"> 
  <h3><a href="/problems/LCH15JEF#comment-95372" class="active">weak test cases , ans should</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/saisumit">saisumit</a></strong>
   <span style="color:#828282"> @ 3 Feb 2015 03:14 AM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    weak test cases , ans should be 6 for test case 1000 2*3 but all solutions as well authors solution is showing it to be 1
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
</div>