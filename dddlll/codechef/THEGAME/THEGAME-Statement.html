<div id="node-9379677" class="node clear-block"> 
 <div class="meta"> 
 </div> 
 <div class="content"> 
  <h3>All submissions for this problem are available.</h3>
  <h3> Read problems statements in <a target="_blank" href="http://www.codechef.com/download/translated/SEPT15/mandarin/THEGAME.pdf">Mandarin</a> and <a target="_blank" href="http://www.codechef.com/download/translated/SEPT15/russian/THEGAME.pdf">Russian</a>. Translations in Vietnamese to be uploaded soon.</h3> 
  <p><img src="https://s3.amazonaws.com/codechef_shared/download/SEPT15/THEGAME.jpg"> </p> 
  <p> Consider a maze like this one, encoded in ASCII as a grid of <b>R</b> by <b>C</b> cells, denoted by characters # (a wall) and o (a walkable cell). The top left cell of the maze is the <i>start</i> and the bottom right one is the <i>goal</i>. All walkable cells are initially white. </p> 
  <p> Cell B is <i>reachable</i> from cell A iff A and B are both walkable and it's possible to get to B by starting at A and moving only to walkable cells in the four cardinal directions — up, right, down and left. </p> 
  <p> The maze is complicated and you're too lazy. That's why you try to solve it using the following algorithm:</p> 
  <ul> 
   <li> Pick a white walkable cell at random and click on it. </li> 
   <li> The cell you picked in the first step and all cells reachable from it turn red. </li> 
   <li> If there's a red path from the start to the goal, you have solved the maze. </li> 
   <li>Else: goto first step. </li> 
  </ul> 
  <p>(Note that once a cell turns red, it will remain red until the maze is solved. Also note that this algorithm will always terminate.) </p> 
  <p> What's the expected number of clicks (<a href="http://mathworld.wolfram.com/ExpectationValue.html">expectation value</a> of the number of clicks) you'll have to make to solve the maze? </p> 
  <h3>Input</h3> 
  <p>The first line of input contains an integer <b>T</b> denoting the number of test cases.</p> 
  <ul> 
   <li> The first line of each test case contains two positive integers <b>R</b> and <b>C</b> — the number of rows and columns of the maze, respectively. </li> 
   <li> The following <b>R</b> lines each contain <b>C</b> characters. Each character is either # or o. </li> 
  </ul> 
  <h3>Output</h3> 
  <p>For each test case, output a single line containing one real number: the expected number of clicks necessary to solve the maze.</p> 
  <h3>Constraints</h3> 
  <ul> 
   <li><b>1</b> ≤ <b>T</b> ≤ <b>100</b></li> 
   <li><i>subtask 1 (15 pts):</i> <b>1</b> ≤ <b>RC</b> ≤ <b>30</b></li> 
   <li><i>subtask 2 (85 pts):</i> <b>1</b> ≤ <b>RC</b> ≤ <b>50000</b></li> 
   <li>At least one path from the start to the goal exists in each test case.</li> 
  </ul> 
  <h3>Example</h3> 
  <pre><b>Input:</b>
2
3 3
o#o
oo#
#oo
2 2
oo
oo

<b>Output:</b>
1.166666667
1.000000000

</pre>
  <h3>Explanation</h3> 
  <p><b>Example case 1.</b> With 5/6 chance, the first click you'll make will be on the only path from the start to the goal. With 1/6 chance, you'll click on the top right cell before that. The expected number of clicks is therefore 5/6*1+1/6*2.</p> 
 </div> 
 <hr> 
 <table cellspacing="0" cellpadding="0" align="left"> 
  <tbody>
   <tr> 
    <td width="14%">Author:</td> 
    <td><a href="/users/xellos0">xellos0</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tester:</td> 
    <td><a href="/users/kevinsogo">kevinsogo</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Editorial</td> 
    <td><a href="http://discuss.codechef.com/problems/THEGAME">http://discuss.codechef.com/problems/THEGAME</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tags</td> 
    <td><a class="problem-tag-small " href="/tags/problems/bfs"> bfs </a><a class="problem-tag-small " href="/tags/problems/dfs"> dfs </a><a class="problem-tag-small " href="/tags/problems/expected-value"> expected-value </a><a class="problem-tag-small " href="/tags/problems/medium-hard"> medium-hard </a><a class="problem-tag-small " href="/tags/problems/probability"> probability </a><a class="problem-tag-small " href="/tags/problems/sept15"> sept15 </a><a class="problem-tag-small " href="/tags/problems/xellos0"> xellos0 </a></td> 
   </tr> 
   <tr> 
    <td width="14%">Date Added:</td> 
    <td>27-01-2015</td> 
   </tr> 
   <tr> 
    <td width="14%">Time Limit:</td> 
    <td>1 - 2 sec</td> 
   </tr> 
   <tr> 
    <td width="14%">Source Limit:</td> 
    <td>50000 Bytes</td> 
   </tr> 
   <tr> 
    <td width="14%">Languages:</td> 
    <td>ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.1.2, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC</td> 
   </tr> 
  </tbody>
 </table> 
 <p style="clear:left;"><br></p> 
 <ul class="button-list button-list-left"> 
  <li style="display:"><a href="/submit/THEGAME">Submit</a></li> 
 </ul> 
 <hr> 
 <h2 style="text-decoration: none;">Comments</h2> 
 <ul class="links inline">
  <li class="comment_forbidden first last"><span><i><strong>Please login at the top to post a comment.</strong></i><p></p></span></li> 
 </ul>
</div>